apiVersion: batch/v1
kind: Job
metadata:
  name: integration-tests
spec:
  backoffLimit: 0
  template:
    spec:
      restartPolicy: Never
      containers:
      - name: integration-tests
        image: curlimages/curl:8.6.0
        command:
        - sh
        - -c
        - |
          set -e

          echo "Checking Frontend..."
          curl -sf http://lugx-service || exit 1

          echo "Checking Game-Service..."
          curl -sf http://game-service-svc/healthz || exit 1

          echo "Checking Order-Service..."
          curl -sf http://order-service-svc/healthz || exit 1

          echo "Checking Analytics-Service..."
          curl -sf http://analytics-service-svc:3000/healthz || exit 1

          echo "Checking ClickHouse..."
          curl -sf http://clickhouse-svc:8123 || exit 1

          echo "All services are healthy"
